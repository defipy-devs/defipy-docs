Search.setIndex({"docnames": ["abstract_uniswap", "index", "overview", "primitive_balancer", "primitive_stableswap", "primitive_uniswapv2", "primitive_uniswapv3", "tutorials/balancer_test", "tutorials/stableswap_test", "uniswapv2/index", "uniswapv2/tutorials/indexing_problem", "uniswapv2/tutorials/swap_deposit", "uniswapv2/tutorials/uniswap_simulation", "uniswapv2/tutorials/uniswap_v2", "uniswapv2/tutorials/withdraw_swap", "uniswapv3/index", "uniswapv3/tutorials/uniswap_v3", "usage"], "filenames": ["abstract_uniswap.rst", "index.rst", "overview.rst", "primitive_balancer.rst", "primitive_stableswap.rst", "primitive_uniswapv2.rst", "primitive_uniswapv3.rst", "tutorials/balancer_test.ipynb", "tutorials/stableswap_test.ipynb", "uniswapv2/index.rst", "uniswapv2/tutorials/indexing_problem.ipynb", "uniswapv2/tutorials/swap_deposit.ipynb", "uniswapv2/tutorials/uniswap_simulation.ipynb", "uniswapv2/tutorials/uniswap_v2.ipynb", "uniswapv2/tutorials/withdraw_swap.ipynb", "uniswapv3/index.rst", "uniswapv3/tutorials/uniswap_v3.ipynb", "usage.rst"], "titles": ["Uniswap", "DeFiPy: DeFi Analytics with Python", "High Level Overview", "Balancer", "StableSwap", "Uniswap V2", "Uniswap V3", "Balancer", "Stableswap", "Uniswap V2", "Indexing Problem", "Swap-Deposit", "Basic Uniswap Simulation", "Abstract Interface (V2)", "Withdraw-Swap", "Uniswap V3", "Abstract Interface (V3)", "Installation"], "terms": {"class": [0, 1, 3, 4, 5, 6], "uniswappi": [0, 1, 5, 6, 9, 11, 12, 14], "process": 0, "x": [0, 2, 5, 10, 11, 12, 13, 14, 16], "y": [0, 2, 5, 10, 11, 13, 14, 16], "amount": [0, 1, 2, 3, 4, 5, 6, 11, 12, 13, 16], "pool": [0, 1, 2, 3, 4, 5, 6, 10, 11, 12, 13, 14, 16], "appli": [0, 5, 11, 13, 14, 16], "lp": [0, 1, 3, 4, 5, 6, 8, 10, 11, 13, 14, 16], "user_nm": [0, 1, 5, 10, 11, 13, 14, 16], "amount0": [0, 6], "amount1": [0, 6], "lwr_tick": [0, 1, 16], "none": [0, 1, 4, 5, 6, 7, 8], "upr_tick": [0, 1, 16], "exchang": [0, 1, 3, 4, 5, 6, 7, 10, 11, 13, 14, 16], "str": [0, 3, 4, 5, 6, 8, 11], "account": [0, 6, 10], "name": [0, 3, 4, 5, 6], "float": [0, 3, 4, 5, 6, 7, 8], "token": [0, 1, 2, 9, 10, 11, 13, 16], "int": [0, 4, 5, 6], "lower": [0, 6], "tick": [0, 6], "posit": [0, 6], "which": [0, 1, 6, 11], "add": [0, 3, 4, 5, 6, 13, 16], "upper": [0, 6, 12], "out": [0, 1, 3, 4, 5, 6, 11, 13, 14], "dictionari": [0, 3, 4, 5, 6], "output": [0, 1, 3, 4, 5, 6], "ev": 0, "tdel": 0, "vice": [0, 2, 6, 13, 16], "vers": [0, 6, 13, 16], "eventselectionmodel": 0, "object": [0, 1, 3, 4], "randomli": 0, "gener": 0, "bui": 0, "vs": 0, "sell": 0, "event": 0, "tokendeltamodel": 0, "token_in": [0, 5, 7, 10, 11, 14], "amount_in": [0, 3, 4, 5], "sqrt_price_limit": 0, "erc20": [0, 1, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 14, 16], "specifi": [0, 4], "amount_out_expect": [0, 5], "withdrawswap": [0, 2, 9, 15], "from": [0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 14, 16], "oppos": [0, 5, 11], "ad": [0, 7], "specif": [0, 3, 4, 11], "receiv": [0, 3, 4, 5, 6, 11], "singl": [0, 3], "token_out": [0, 7, 14], "amount_out": [0, 5, 13], "withdrawn": [0, 6, 14], "get_trading_token": 0, "get": [0, 3, 4, 5, 6, 10, 11, 14], "trading_token": [0, 14], "swapdeposit": [0, 2, 9, 11, 15], "approx": [0, 11, 13, 16], "half": 0, "proce": 0, "plu": 0, "remain": [0, 2, 11, 13, 16], "other": [0, 2, 3, 4, 5], "approxim": [0, 2, 10], "addliquid": [0, 2, 9, 15], "init_pric": [0, 1], "us": [0, 1, 2, 3, 4, 6, 9, 11, 12, 13, 14, 16], "onli": [0, 1, 6, 10, 13, 16], "removeliquid": [0, 2, 9, 14, 15], "remov": [0, 3, 4, 5, 6, 13, 16], "reserv": [0, 1, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 14, 16], "world": 1, "first": [1, 11, 17], "packag": [1, 17], "all": [1, 3, 4, 6, 7, 10, 11], "major": 1, "protocol": [1, 2, 6, 17], "integr": [1, 2, 11, 14], "one": [1, 2, 5, 6, 11], "sinc": 1, "built": 1, "modular": 1, "design": 1, "mind": 1, "your": [1, 17], "can": [1, 2, 6, 10, 11, 14], "also": [1, 3, 4, 5, 6, 17], "silo": 1, "balancerpi": [1, 3], "stableswappi": [1, 4], "To": [1, 2, 6, 11, 17], "setup": [1, 2, 17], "liquid": [1, 3, 4, 5, 6, 10, 11, 12, 13, 14, 16], "you": [1, 2], "must": [1, 6, 11, 17], "creat": [1, 3, 4, 5, 6], "pair": [1, 2, 3, 4, 5, 6], "next": [1, 6], "factori": [1, 3, 4, 5, 6, 7, 8, 10, 11, 13, 14, 16], "uniswapexchangedata": [1, 5, 6, 10, 11, 13, 14, 16], "data": [1, 3, 4, 5, 6], "avail": [1, 2], "via": [1, 3, 6, 10, 14], "primit": 1, "api": [1, 2, 12], "abstract": [1, 9, 15], "tool": 1, "see": [1, 10, 11, 17], "interfac": [1, 9, 15], "tutori": [1, 2], "For": [1, 11], "basic": 1, "follow": [1, 2, 7, 10, 11, 14], "import": [1, 7, 8, 10, 11, 12, 13, 14, 16], "user_intro": 1, "eth_amount": [1, 10, 11, 13, 14, 16], "3162": 1, "277660168379": 1, "dai_amount": [1, 10], "316227": 1, "7660168379": 1, "dai": [1, 7, 10, 12], "0x111": [1, 7, 10, 11, 12, 13, 14, 16], "eth": [1, 10, 11, 13, 14, 16], "0x09": [1, 7, 10, 11, 12, 13, 14, 16], "exchg_data": [1, 3, 4, 5, 6, 7, 8, 10, 11, 13, 14, 16], "tkn0": [1, 10, 11, 13, 14, 16], "tkn1": [1, 10, 11, 13, 14, 16], "symbol": [1, 3, 4, 7, 8, 10, 11, 13, 14, 16], "address": [1, 3, 4, 5, 6, 7, 8, 10, 11, 13, 14, 16], "0x011": [1, 7, 8, 10, 11, 13, 14, 16], "uniswapfactori": [1, 5, 6, 10, 11, 13, 14, 16], "0x2": [1, 7, 8, 10, 11, 13, 14, 16], "deploi": [1, 3, 4, 5, 6, 7, 8, 10, 11, 13, 14, 16], "add_liquid": [1, 4, 5, 8, 10, 11, 14], "user0": [1, 11, 14, 16], "summari": [1, 3, 4, 5, 6, 7, 8, 10, 11, 13, 14, 16], "31622": [1, 10, 11, 13], "776601683792": [1, 10, 11, 13], "simular": 1, "abov": [1, 10, 11, 14, 17], "onc": [1, 17], "thi": [1, 2, 6, 10, 11], "an": [1, 2, 3, 4, 5, 6, 7, 11], "unlimit": 1, "user": [1, 3, 4, 5, 6, 7, 8, 13], "fee": [1, 4, 6, 10, 14, 16], "univ3util": [1, 16], "feeamount": [1, 16], "medium": [1, 12, 16], "tick_spac": [1, 16], "getmintick": [1, 16], "getmaxtick": [1, 16], "encodepricesqrt": 1, "100": [1, 7, 10, 11, 13, 14, 16], "1": [1, 7, 8, 10, 11, 12, 13, 14, 16], "version": [1, 2, 16], "initi": [1, 3, 4, 5, 6, 7, 11, 14], "mint": [1, 3, 4, 5, 6], "left": [1, 2, 6, 10, 11, 12, 14], "side": 1, "menu": [1, 2], "serv": 1, "extens": 1, "constant": [1, 4, 10, 14], "product": [1, 4, 10, 14], "trade": [1, 2, 10, 14], "ie": [1, 3, 4, 5, 10, 14], "handl": [1, 17], "more": [1, 2, 17], "than": [1, 6], "two": [1, 2, 7, 11], "asset": [1, 3, 4, 5, 7, 10, 11], "ar": [1, 2, 6, 7, 10, 11, 13, 16], "known": 1, "weight": [1, 4, 7], "As": [1, 2, 10], "both": [1, 5, 10, 11], "muilt": 1, "thei": 1, "have": [1, 6, 10, 11, 17], "what": [1, 5], "call": [1, 3, 4, 6], "vault": [1, 7, 8], "tout": 1, "being": 1, "defin": [1, 9], "featur": 1, "henc": [1, 10, 14], "we": [1, 2, 6, 10, 11, 14], "includ": [1, 11], "balancervault": [1, 3, 7], "stableswapvault": [1, 4, 8], "shown": 1, "user_test": [1, 7, 8, 10], "amt_dai": [1, 7, 8], "10000000": [1, 7], "denorm_wt_dai": [1, 7], "10": [1, 7, 8, 10, 11, 12, 13, 14, 16], "amt_eth": [1, 7], "67738": [1, 7], "6361731024": [1, 7], "denorm_wt_eth": [1, 7], "40": [1, 7], "init_pool_shar": [1, 7], "0x01": 1, "deposit": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16], "weth": [1, 7], "0x02": 1, "bgrp": [1, 7], "add_token": [1, 3, 4, 7, 8], "bfactori": [1, 7], "balancerfactori": [1, 3, 7], "0x": 1, "balancerexchangedata": [1, 3, 7], "0x1": 1, "join_pool": [1, 3, 4, 7, 8], "0": [1, 5, 6, 7, 8, 10, 11, 12, 13, 14, 16], "2": [1, 7, 8, 10, 11, 12, 13, 14, 16], "8": [1, 7, 8, 10, 11, 12, 13, 14, 16], "share": [1, 3, 4, 6], "lesser": 1, "implement": [1, 2, 4, 7, 12], "compos": 1, "stabl": 1, "ideal": 1, "set": [1, 3, 4, 6, 10], "up": [1, 10], "coin": [1, 5], "ampl_coeff": [1, 4, 8], "2000": [1, 8, 10], "79566307": [1, 8], "559825807715868071": [1, 8], "decimal_dai": [1, 8], "18": [1, 7, 8, 12, 13], "amt_usdc": [1, 8], "81345068": [1, 8], "187939": [1, 8], "decimal_usdc": [1, 8], "6": [1, 7, 8, 10, 11, 12, 13, 14, 16], "amt_usdt": [1, 8], "55663250": [1, 8], "772939": [1, 8], "decimal_usdt": [1, 8], "usdc": [1, 11], "usdt": 1, "0x03": 1, "sgrp": [1, 8], "sfactori": [1, 8], "stableswapfactori": [1, 4, 8], "stableswapexchangedata": [1, 4, 8], "0x11": 1, "55982581": [1, 8], "216573027": [1, 8], "91811988": [1, 8], "These": [1, 11], "doc": [1, 17], "intend": 1, "anyon": 1, "who": [1, 2], "build": 1, "whether": [1, 3, 4, 6], "re": [1, 7, 8, 14], "aggreg": 1, "yield": 1, "trader": 1, "provid": 1, "founder": 1, "web": 1, "dev": [1, 7, 17], "arbitrageur": 1, "amm": 1, "mathematician": 1, "curiou": 1, "individu": 1, "place": 1, "check": [1, 3, 4, 6, 9, 14], "instal": 1, "section": 1, "further": 1, "inform": 1, "how": [1, 3, 4, 6, 10, 11, 12], "project": 1, "under": [1, 11], "activ": 1, "develop": [1, 2], "The": [2, 6, 7, 10, 11, 14], "main": [2, 7], "wai": 2, "work": [2, 10], "defipi": [2, 7, 8, 13, 16, 17], "either": [2, 5, 6], "through": [2, 11, 14], "backbon": 2, "consist": [2, 7], "refactor": [2, 7], "variou": 2, "defi": 2, "solid": [2, 7], "framework": 2, "analyz": 2, "mock": 2, "python": [2, 7, 17], "ve": 2, "done": [2, 6], "our": [2, 10, 11, 14], "best": 2, "maintain": 2, "origin": [2, 10], "offer": 2, "option": [2, 4, 5, 6], "suit": 2, "familiar": 2, "want": [2, 10], "addit": [2, 7], "support": 2, "resourc": [2, 7], "analyst": 2, "streamlin": 2, "analyt": 2, "made": 2, "overiew": 2, "learn": 2, "visit": 2, "refer": 2, "join": [2, 9, 15], "swap": [2, 3, 4, 5, 6, 9, 10, 15], "exact": [2, 6, 13, 16], "versa": 2, "come": [2, 3, 4], "just": 2, "make": 2, "calcul": [2, 5, 6, 7, 11, 13, 14, 16], "portion": [2, 5, 11, 14], "perform": [2, 11, 13, 16], "aquir": 2, "50": [2, 11, 13, 14, 16], "withdraw": [2, 3, 6, 9, 13, 16], "leav": 2, "desir": [2, 5, 13, 16], "return": [2, 5, 6, 10, 11, 13, 14, 16], "enter": 2, "manual_balanc": 3, "balancerexchang": [3, 7], "factory_struct": [3, 4, 5, 6], "factorydata": [3, 4, 5, 6], "exchg_struct": [3, 4, 5, 6], "autom": [3, 4], "market": [3, 4], "maker": [3, 4], "self": [3, 4], "burn": [3, 4, 5, 6], "amt_tkn_out": [3, 4, 7], "tkn_out": [3, 4, 7, 8], "_from": [3, 4, 5, 6], "base": [3, 4, 5, 7, 12, 13, 16], "number": 3, "request": [3, 4, 14], "exit_pool": 3, "amt_shares_out": [3, 7], "within": [3, 4, 6, 17], "exit": 3, "exit_swap_extern_amount_out": [3, 7], "exit_swap_pool_amount_in": [3, 7], "get_amount_in": [3, 7], "tkn_in": [3, 4, 7, 8], "given": [3, 4, 5, 6, 10, 11, 14], "some": [3, 4, 10], "equival": [3, 4, 5], "input": [3, 4, 5, 6], "get_amount_out": [3, 4, 5, 7], "amt_tkn_in": [3, 4, 7, 8], "get_pric": [3, 4, 5, 7, 8], "base_tkn": [3, 4], "opp_tkn": [3, 4], "price": [3, 4, 5, 6, 12], "select": [3, 4, 5, 6, 7], "denomin": [3, 4, 6], "get_reserv": [3, 4, 5, 6, 8, 10], "amt_shares_in": [3, 4, 7], "tkn_grvaultoup": 3, "balancererc20group": 3, "group": [3, 4, 8], "join_swap_extern_amount_in": [3, 7], "join_swap_pool_amount_out": [3, 7], "new_shar": [3, 4], "updat": [3, 4, 5], "new": [3, 4, 5, 6], "summar": 3, "current": [3, 4, 6], "state": [3, 4], "amt_swap": 3, "amt_fe": 3, "amt_out": [3, 5, 14], "swape": [3, 4], "swap_exact_amount_in": [3, 7], "swap_exact_amount_out": [3, 7], "newli": [3, 4, 5, 6], "get_exchang": [3, 4, 5, 6], "map": [3, 4, 5, 6, 7], "get_token": [3, 4, 5, 6, 8], "manag": [3, 4], "tkn": [3, 4, 5, 8, 11, 12, 13, 14, 16], "list": [3, 4], "tkn_dic": [3, 4], "referenc": [3, 4], "tkn_denorm_wt": 3, "denorm": [3, 7], "tkn_bound": 3, "boolean": [3, 4, 5], "indic": [3, 4, 6], "bound": 3, "bool": [3, 6], "true": [3, 4, 5, 6], "check_tkn": [3, 4], "contain": [3, 4], "get_bal": [3, 4], "referen": [3, 4], "tkn_balanc": [3, 4, 8], "dict": [3, 4], "get_bound": 3, "norm_wts_dict": [3, 4], "get_denorm_weight": 3, "get_norm_weight": 3, "get_dict": [3, 4], "tkn_dict": [3, 4], "get_nam": [3, 4], "tkn_nm": [3, 4, 8], "delimit": [3, 4], "hyphen": [3, 4], "string": [3, 4], "normal": [3, 7], "tkn_name": [3, 4], "its": [3, 4, 5, 10], "retriev": [3, 4], "cwpquot": 3, "get_amount_from_shar": 3, "amount_shares_in": 3, "uniswapexchang": [3, 4, 5, 6], "uniswap": [3, 4], "cwpt": [3, 4, 7], "get_shares_from_amount": 3, "lp_amt": [3, 4], "erc": [3, 4, 5, 6], "addr": [3, 4, 5, 6], "token_nam": [3, 4, 5, 6, 7, 8, 10, 11, 14], "token_addr": [3, 4, 5, 6], "token_tot": [3, 4, 5, 6, 8], "hold": [3, 4, 5, 6], "valu": [3, 4, 5, 6, 8, 10], "delta": [3, 4, 5, 6, 10, 11, 14], "total": [3, 4, 5, 6, 10, 11, 14], "transfer": [3, 4, 5, 6], "_to": [3, 4, 5, 6], "manual_stableswap": 4, "stableswapexchang": 4, "tkn_amt_in": 4, "liquidity_out": 4, "tkn_out_amt": [4, 7, 8], "get_math_pool": [4, 8], "underli": 4, "stableswappoolmath": 4, "math_pool": [4, 8], "math": [4, 7, 10, 11, 14], "curveresearch": 4, "github": [4, 17], "repo": [4, 7], "fals": [4, 6, 10, 12], "stableswaperc20group": 4, "new_liquid": 4, "remove_liquid": [4, 5, 8], "liquidity_amt_out": 4, "use_fe": 4, "print": [4, 5, 6, 7, 8, 10, 11, 12, 14], "amt2dec": 4, "tkn_amt": 4, "decim": [4, 5, 6, 8], "convert": 4, "balanc": [4, 6], "get_decimal_amt": [4, 8], "format": [4, 11, 14], "decimal_amt": 4, "get_decim": 4, "get_rat": 4, "rate": [4, 14], "tkn_rate": 4, "csquot": 4, "get_lp_from_amount": [4, 5, 10], "reset": [4, 5, 6], "cpt": [5, 6, 10, 14], "exchange_from_token": [5, 6], "tokens_from_exchang": [5, 6], "exchg": [5, 6], "factoryinit": [5, 6], "uniswapexchangeinit": [5, 6], "_from_addr": 5, "amountadesir": 5, "amountbdesir": 5, "amountamin": 5, "amountbmin": 5, "A": [5, 11, 14], "b": [5, 10, 11, 12, 14], "minimum": [5, 6], "to_addr": 5, "amounta": 5, "amountb": 5, "est": 5, "reserve0": [5, 10, 11, 14], "reserve1": [5, 10, 11, 14], "maximum": 5, "get_amount_out0": 5, "get_amount_out1": 5, "get_amount": 5, "get_liquid": [5, 6], "_amounta": 5, "_amountb": 5, "each": 5, "reservea": 5, "reserveb": 5, "amounta_out": 5, "amountb_out": 5, "swap_exact_tokens_for_token": 5, "amountin": 5, "amountoutmin": 5, "amt": [5, 8, 11, 14], "min": 5, "expect": [5, 11, 13, 16], "update_reserv": 5, "amounta_upd": 5, "amountb_upd": 5, "acccount": 5, "holder": 5, "indextokenquot": 5, "quote_native_token": 5, "otherwis": 5, "base_x_asset": 5, "base_y_asset": 5, "get_base_lp": 5, "parent": 5, "child": 5, "get_native_x": 5, "tkn_x": 5, "x_amt": 5, "get_native_i": 5, "tkn_y": 5, "y_amt": 5, "get_x": 5, "amt_lp": 5, "xy": [5, 10, 14], "k": [5, 8, 12], "get_i": 5, "lpquot": [5, 10], "quote_oppos": [5, 10], "default": 5, "get_amount_from_lp": [5, 10], "amount_lp_in": 5, "get_opposing_token": 5, "price_tkn": 5, "respect": 5, "rebaseindextoken": 5, "determin": [5, 6, 11, 13, 14, 16], "rebas": 5, "certain": [5, 11], "invers": 5, "settlementlptoken": 5, "liq_amt": 5, "settlement": [5, 14], "term": 5, "rebase_amount": 5, "itkn_amt": [5, 10, 14], "lp_amount": 5, "lperc20": [5, 6], "daosi": [5, 6], "type": [5, 6], "add_token_lp": [5, 6], "remove_token_lp": [5, 6], "set_token_lp": [5, 6], "uniswapv3exchang": 6, "recipi": 6, "ticklow": 6, "tickupp": 6, "sender": 6, "ow": 6, "trigger": 6, "recalcul": 6, "collect": 6, "separ": 6, "much": [6, 10], "token0": [6, 11], "when": [6, 11, 14], "neg": 6, "token1": [6, 10, 14], "checktick": 6, "common": 6, "valid": [6, 10], "amount0request": 6, "amount1request": 6, "doe": [6, 8], "recomput": 6, "earn": 6, "ani": 6, "owner": 6, "mai": 6, "zero": [6, 12], "caller": 6, "pass": [6, 8], "greater": 6, "actual": 6, "e": 6, "g": 6, "uint128": 6, "max": 6, "accumul": 6, "should": [6, 11], "wa": [6, 7, 8], "paid": 6, "get_virtual_reserv": 6, "virtual": 6, "sqrtpricex96": 6, "sqrt": [6, 10, 11, 14], "q64": 6, "96": 6, "final": [6, 9], "automat": 6, "swapper": 6, "due": 6, "depend": 6, "nexttick": 6, "lte": 6, "It": 6, "assum": [6, 10], "kei": 6, "min_tick": 6, "max_tick": 6, "alwai": 6, "case": [6, 17], "don": 6, "t": 6, "run": [6, 11, 12, 14], "risk": 6, "overshoot": 6, "ticknext": 6, "boundari": 6, "long": 6, "been": [6, 14], "howev": [6, 10, 11], "right": [6, 10, 11, 14], "Then": 6, "need": [6, 11, 17], "init": 6, "start": [6, 10, 12], "search": 6, "less": 6, "equal": [6, 11], "function": [6, 12], "setfeeprotocol": 6, "feeprotocol0": 6, "feeprotocol1": 6, "s": [6, 10, 11, 14], "zeroforon": 6, "amountspecifi": 6, "sqrtpricelimitx96": 6, "end": [6, 11, 14], "direct": 6, "implicitli": 6, "configur": 6, "limit": 6, "If": 6, "cannot": 6, "after": [6, 11], "swap0forexact1": 6, "sqrtpricelimit": 6, "swapexact0for1": 6, "highest": 6, "directli": 6, "swap1forexact0": 6, "swapexact1for0": 6, "broadli": 7, "compon": 7, "balancermath": 7, "py": 7, "v1": 7, "contract": 7, "code": 7, "copi": 7, "balancerpools_model": 7, "gh": 7, "bmath": 7, "calcspotpric": 7, "calc_spot_pric": 7, "calcoutgivenin": 7, "calc_out_given_in": 7, "calcingivenout": 7, "calc_in_given_out": 7, "calcpooloutgivensinglein": 7, "calc_pool_out_given_single_in": 7, "calcsingleingivenpoolout": 7, "calc_single_in_given_pool_out": 7, "calcpoolingivensingleout": 7, "calc_pool_in_given_single_out": 7, "calcsingleoutgivenpoolin": 7, "calc_single_out_given_pool_in": 7, "os": [7, 11, 12, 14], "json": [7, 8], "numpi": [7, 8, 11, 12, 14], "np": [7, 8, 11, 12, 14], "test": 7, "extract": 7, "3": [7, 8, 10, 11, 12, 13, 14, 16, 17], "cwd": 7, "getcwd": 7, "replac": 7, "notebook": 7, "chdir": 7, "actions_json": 7, "0x8b6e6e7b5b3801fed2cafd4b22b8a16c2f2db21a": 7, "action": 7, "open": 7, "r": 7, "f": [7, 8, 10, 12], "pool_act": 7, "load": 7, "loos": 7, "target": 7, "percentag": [7, 13, 16], "deploy": 7, "sum": 7, "typic": 7, "4": [7, 8, 10, 11, 12, 13, 14, 16], "5": [7, 8, 10, 11, 12, 13, 14, 16], "p": 7, "591": 7, "984912776992": 7, "7": [7, 8, 10, 11, 12, 13, 14, 16, 17], "11861": 7, "328308361": 7, "20": [7, 8, 10, 12, 13], "021734704865246": 7, "10011861": 7, "32830836": 7, "67718": 7, "61443839753": 7, "9": [7, 8, 10, 11, 12, 13, 14, 16], "tkn_in_amt": 7, "11878": 7, "911104285744": 7, "9999982": 7, "417204075": 7, "11": [7, 8, 10, 11, 12, 13, 14, 16], "336": 7, "result": 7, "anaddit": 7, "shares_in_amt": 7, "26": [7, 8], "741601415598677": 7, "03156505964916199": 7, "12": [7, 8, 10, 11, 12, 13, 16], "67765": 7, "377774518": 7, "03156505964917": 7, "13": [7, 8, 10, 12, 13, 16], "were": 7, "8575": 7, "568763821291": 7, "14": [7, 8, 10, 11, 12, 13], "76340": 7, "94653833928": 7, "110": 7, "15": [7, 8, 10, 12, 13], "664": 7, "shares_out_amt": 7, "27": 7, "036668416618735": 7, "031191445644352424": 7, "16": [7, 8, 12, 13], "76313": 7, "90986992266": 7, "00037361400481": 7, "17": [7, 8, 12, 13], "8566": 7, "8415530723": 7, "67747": 7, "06831685036": 7, "0xa0b": 8, "0xf93": 8, "0xd7c": 8, "p_usdc_dai": 8, "p_dai_usdc": 8, "9999896456022903": 8, "0000103545049244": 8, "usdc_befor": 8, "usdt_befor": 8, "10000": [8, 12, 13, 16], "9996": 8, "862748": 8, "leak": 8, "usdc_check": 8, "usdt_check": 8, "usdc_test": 8, "els": [8, 10, 11, 14], "fail": 8, "usdt_test": 8, "81355068": 8, "55653253": 8, "910191": 8, "dai_befor": 8, "9998": 8, "895308918858": 8, "dai_check": 8, "dai_test": 8, "79556308": 8, "6645169": 8, "81365068": 8, "liquidity_amt_in": 8, "919116999057": 8, "55663253": 8, "216583028": 8, "83723688": 8, "968444705135": 8, "79566308": 8, "216593027": 8, "8056816": 8, "amt_lp_out": 8, "250000": 8, "lp_amt_befor": 8, "total_suppli": [8, 10, 13, 14], "250001": 8, "94300082736": 8, "lp_amt_check": 8, "lp_amt_test": 8, "79316306": 8, "72151607": 8, "216343027": 8, "500000": 8, "500009": 8, "469211": 8, "19": [8, 10, 12, 13], "80865058": 8, "718728": 8, "215843027": 8, "499898": 8, "496234": 8, "21": [8, 12, 13], "55163355": 8, "413957": 8, "215343027": 8, "22": [8, 12, 13], "tkn_decimal_amt": 8, "23": [8, 10, 12, 13], "lp_test": 8, "round": 8, "24": [8, 12], "enumer": 8, "tkn_reserv": 8, "tkn_math_pool_bal": 8, "token_decim": 8, "assert": 8, "error": 8, "NOT": 8, "match": 8, "WITH": 8, "25": [8, 12], "problem": 9, "solv": [9, 10], "step": 9, "distribut": [9, 11], "solut": [9, 10, 11], "index": [9, 14], "naiv": 9, "approach": 9, "ipython": 10, "displai": 10, "imag": 10, "1000": [10, 11, 13, 14, 16], "1000000": [10, 11], "dl": [10, 14], "know": 10, "home": 10, "worth": 10, "let": [10, 11, 14], "frac": [10, 11, 14], "l": [10, 14], "dx": [10, 11, 14], "2l": 10, "substitut": 10, "2x": 10, "nbsphinx": 10, "sim": 10, "likewis": 10, "logic": 10, "ok": 10, "small": 10, "so": 10, "suppli": [10, 14], "lp_posit": 10, "01": 10, "naive_approxim": 10, "5f": 10, "napproach": 10, "316": 10, "22777": 10, "00000": 10, "larg": 10, "77660": 10, "complet": 10, "off": 10, "indexed_tkn": 10, "png": 10, "width": 10, "300": 10, "height": 10, "definit": [10, 14], "gamma": [10, 14], "where": [10, 11, 14], "r0": [10, 14], "r1": [10, 14], "a0": [10, 14], "a1": [10, 14], "997": [10, 11, 14], "linear": [10, 14], "system": [10, 11, 14, 17], "equat": [10, 11, 14], "eq": [10, 11, 14], "y_": [10, 14], "i": [10, 14], "def": [10, 11, 14], "calc_tkn_settl": 10, "dy1": 10, "dy2": 10, "delta_l": 10, "delta_eth": 10, "delta_dai": 10, "06315": 10, "63": 10, "14969": 10, "settlement_lp_tkn": 10, "now": [10, 11, 14], "outlin": [10, 14], "rearrang": [10, 14], "plug": [10, 11, 14], "reduc": [10, 11, 14], "quadrat": [10, 11, 14], "1000xy": [10, 14], "1000l": [10, 14], "calc_lp_settl": [10, 14], "a2": [10, 14], "c": [10, 11, 12, 14], "delta_eth_lp": 10, "delta_dai_lp": 10, "quot": [10, 11], "mechanisim": 10, "back": 10, "size": 10, "against": [10, 11], "indexed_approach": 10, "2f": [10, 11], "00": 10, "87": 10, "pretti": 10, "close": 10, "try": 10, "78": 10, "excel": 10, "01583514496167512": 10, "termcolor": [11, 14], "color": [11, 12, 14], "usdc_amount": 11, "oper": 11, "incom": 11, "fund": 11, "achiev": 11, "ensur": 11, "alpha": [11, 14], "s_": 11, "begin": [11, 14], "x_": 11, "1000x": 11, "tag": [11, 14], "highlight": 11, "why": 11, "consider": 11, "niniti": [11, 14], "n": [11, 14], "s_in": 11, "s_out": 11, "nlp": [11, 14], "post": [11, 14], "balance0": 11, "balance1": 11, "along": 11, "ntotal": 11, "6f": [11, 14], "unaccount": 11, "consid": 11, "split": [11, 14], "red": 11, "attr": 11, "bold": 11, "1050": [11, 14], "952517": 11, "026241844": 11, "1100": [11, 14, 16], "997874": 11, "9798724081": 11, "33128": 11, "623106525876": 11, "47482": 11, "973758155924": 11, "000000": [11, 14], "2125": 11, "02012759191": 11, "mani": [11, 17], "97": [11, 14], "a1_out": 11, "instead": 11, "102": 11, "34": 11, "imbal": 11, "proper": 11, "1997": 11, "correct": [11, 14], "calc_deposit_dist": 11, "calc_deposit_port": 11, "tkn_suppli": 11, "distrbut": 11, "4888217399419355": 11, "684341886080802e": 11, "compar": [11, 14], "1048": [11, 14], "8821739941936": 11, "953529": 11, "2490856305": 11, "33163": 11, "92929950274": 11, "48": [11, 14], "88217399419355": 11, "46470": 11, "75091436944": 11, "51": [11, 14], "117826005806386": 11, "882174": 11, "117826": 11, "dep": 11, "articl": 12, "decentr": 12, "financ": 12, "panda": 12, "pd": 12, "matplotlib": 12, "pyplot": 12, "plt": 12, "pymc": 12, "datetim": 12, "warn": 12, "pytensor": 12, "tensor": 12, "bla": 12, "n_step": 12, "5000": 12, "start_pric": 12, "mu": 12, "sigma": 12, "n_path": 12, "brownianmodel": 12, "p_arr": 12, "gen_gbm": 12, "exp_p_arr": 12, "median": 12, "axi": 12, "t_delta": 12, "linspac": 12, "365": 12, "num": 12, "2023": 12, "date_tim": 12, "arrai": 12, "timedelta": 12, "fig": 12, "figur": 12, "figsiz": 12, "usd_ax": 12, "gca": 12, "gp": 12, "util": 12, "plot_gp_dist": 12, "ax": 12, "sampl": 12, "transpos": 12, "palett": 12, "cool": 12, "plot_sampl": 12, "plot": 12, "white": 12, "linestyl": 12, "dash": 12, "label": 12, "sysusd": 12, "set_titl": 12, "gbm": 12, "sy": 12, "usd": 12, "fontsiz": 12, "set_ylabel": 12, "legend": 12, "facecolor": 12, "lightgrai": 12, "loc": 12, "lt": 12, "0x1649c3dc0": 12, "gt": 12, "sys_arr": 12, "float64": 12, "x_amt_arr": 12, "y_amt_arr": 12, "rang": 12, "trial": 12, "p_trial_arr": 12, "lp_sim": 12, "simplelpsimul": 12, "init_amt": 12, "create_lp": 12, "get_tkn_price_sim": 12, "get_x_amt_sim": 12, "get_y_amt_sim": 12, "p_ax": 12, "sys_ax": 12, "dai_ax": 12, "subplot": 12, "nrow": 12, "sharex": 12, "sharei": 12, "mean": 12, "w": 12, "linewidth": 12, "text": 12, "39": 12, "tkn_amount": [13, 14, 16], "100000": [13, 14, 16], "990": [13, 16], "1284196560293": [13, 16], "101000": [13, 16], "1010": [13, 16], "99012": [13, 16], "84196560294": [13, 16], "lp_tkn": 13, "tkn2": 13, "0x112": 13, "lp_tkn_amount": 13, "lp2": 13, "0x012": 13, "ethtkn": 13, "10100": [13, 16], "9990": 13, "039930189601": 13, "100100": 13, "10001": 13, "100010": 13, "31625": 13, "93887934396": 13, "10010": 13, "31654": 13, "399378285478": 13, "999": 13, "99900": 13, "10004": [13, 16], "991241237401": [13, 16], "1001": 13, "0000000000001": 13, "1009": [13, 16], "9999999999998": [13, 16], "1004": 13, "9800695579358": 13, "upon": [13, 16], "expected_amount_out": [13, 16], "998": [13, 16], "9999999999999": 13, "9994": [13, 16], "99123998928": [13, 16], "99899": [13, 16], "99999999999": [13, 16], "989": 13, "994": 13, "9799447405355": 13, "mth": 14, "user_nm1": 14, "p_out": 14, "removeliq": 14, "Of": 14, "ha": 14, "10488": 14, "088481701516": 14, "95454": 14, "54545454546": 14, "10011": 14, "35718707872": 14, "1002": 14, "4094194662908": 14, "47": 14, "590581": 14, "eth_amt": 14, "requir": [14, 17], "488": 14, "787567": 14, "587935447692871e": 14, "09": 14, "reconsid": 14, "redefin": 14, "thu": 14, "therefor": 14, "solver": 14, "calc_port": 14, "calc_withdraw_port": 14, "dy": 14, "aswap": 14, "512645": 14, "735527472211": 14, "95339": 14, "59340656463": 14, "9999": 14, "300914574964": 14, "264473": 14, "735527": 14, "per": 14, "real": 16, "110000": 16, "11000": 16, "99000": 16, "9900": 16, "100099": 16, "99992503764": 16, "9999253728399": 16, "10049": 16, "800695579359": 16, "gmpy2": 17, "precis": 17, "stableswap": 17, "cpython": 17, "latest": 17, "releas": 17, "pip": 17, "librari": 17, "gmp": 17, "mpfr": 17, "mpc": 17, "alreadi": 17, "info": 17, "git": 17, "clone": 17, "http": 17, "com": 17}, "objects": {"balancerpy": [[3, 0, 0, "-", "erc"], [3, 0, 0, "-", "vault"]], "balancerpy.erc": [[3, 1, 1, "", "ERC20"]], "balancerpy.erc.ERC20": [[3, 2, 1, "", "deposit"], [3, 2, 1, "", "transfer"]], "balancerpy.vault": [[3, 1, 1, "", "BalancerVault"]], "balancerpy.vault.BalancerVault": [[3, 2, 1, "", "add_token"], [3, 2, 1, "", "check_tkn"], [3, 2, 1, "", "get_balances"], [3, 2, 1, "", "get_bounds"], [3, 2, 1, "", "get_denorm_weights"], [3, 2, 1, "", "get_dict"], [3, 2, 1, "", "get_name"], [3, 2, 1, "", "get_names"], [3, 2, 1, "", "get_norm_weights"], [3, 2, 1, "", "get_token"], [3, 2, 1, "", "get_tokens"]], "": [[3, 0, 0, "module-0", "manual_balancer"], [4, 0, 0, "module-0", "manual_stableswap"]], "manual_balancer": [[3, 1, 1, "", "BalancerExchange"], [3, 1, 1, "", "BalancerFactory"], [3, 1, 1, "", "CWPQuote"]], "manual_balancer.BalancerExchange": [[3, 2, 1, "", "burn"], [3, 2, 1, "", "exit_pool"], [3, 2, 1, "", "exit_swap_extern_amount_out"], [3, 2, 1, "", "exit_swap_pool_amount_in"], [3, 2, 1, "", "get_amount_in"], [3, 2, 1, "", "get_amount_out"], [3, 2, 1, "", "get_price"], [3, 2, 1, "", "get_reserve"], [3, 2, 1, "", "join_pool"], [3, 2, 1, "", "join_swap_extern_amount_in"], [3, 2, 1, "", "join_swap_pool_amount_out"], [3, 2, 1, "", "mint"], [3, 2, 1, "", "summary"], [3, 2, 1, "", "swap"], [3, 2, 1, "", "swap_exact_amount_in"], [3, 2, 1, "", "swap_exact_amount_out"]], "manual_balancer.BalancerFactory": [[3, 2, 1, "", "deploy"], [3, 2, 1, "", "get_exchange"], [3, 2, 1, "", "get_token"]], "manual_balancer.CWPQuote": [[3, 2, 1, "", "get_amount_from_shares"], [3, 2, 1, "", "get_shares_from_amount"]], "manual_stableswap": [[4, 1, 1, "", "CSQuote"], [4, 1, 1, "", "StableswapExchange"], [4, 1, 1, "", "StableswapFactory"]], "manual_stableswap.CSQuote": [[4, 2, 1, "", "get_lp_from_amount"]], "manual_stableswap.StableswapExchange": [[4, 2, 1, "", "add_liquidity"], [4, 2, 1, "", "burn"], [4, 2, 1, "", "get_amount_out"], [4, 2, 1, "", "get_math_pool"], [4, 2, 1, "", "get_price"], [4, 2, 1, "", "get_reserve"], [4, 2, 1, "", "join_pool"], [4, 2, 1, "", "mint"], [4, 2, 1, "", "remove_liquidity"], [4, 2, 1, "", "summary"], [4, 2, 1, "", "swap"]], "manual_stableswap.StableswapFactory": [[4, 2, 1, "", "deploy"], [4, 2, 1, "", "get_exchange"], [4, 2, 1, "", "get_token"]], "stableswappy": [[4, 0, 0, "-", "erc"], [4, 0, 0, "-", "vault"]], "stableswappy.erc": [[4, 1, 1, "", "ERC20"]], "stableswappy.erc.ERC20": [[4, 2, 1, "", "deposit"], [4, 2, 1, "", "transfer"]], "stableswappy.vault": [[4, 1, 1, "", "StableswapVault"]], "stableswappy.vault.StableswapVault": [[4, 2, 1, "", "add_token"], [4, 2, 1, "", "amt2dec"], [4, 2, 1, "", "check_tkn"], [4, 2, 1, "", "get_balances"], [4, 2, 1, "", "get_decimal_amts"], [4, 2, 1, "", "get_decimals"], [4, 2, 1, "", "get_dict"], [4, 2, 1, "", "get_name"], [4, 2, 1, "", "get_names"], [4, 2, 1, "", "get_rates"], [4, 2, 1, "", "get_token"], [4, 2, 1, "", "get_tokens"]], "uniswappy.cpt": [[6, 0, 0, "-", "exchg"], [6, 0, 0, "-", "factory"], [5, 0, 0, "-", "index"], [5, 0, 0, "-", "quote"]], "uniswappy.cpt.exchg": [[5, 1, 1, "", "UniswapExchange"], [6, 1, 1, "", "UniswapV3Exchange"]], "uniswappy.cpt.exchg.UniswapExchange": [[5, 2, 1, "", "add_liquidity"], [5, 2, 1, "", "burn"], [5, 2, 1, "", "get_amount_out"], [5, 2, 1, "", "get_amount_out0"], [5, 2, 1, "", "get_amount_out1"], [5, 2, 1, "", "get_amounts"], [5, 2, 1, "", "get_liquidity"], [5, 2, 1, "", "get_price"], [5, 2, 1, "", "get_reserve"], [5, 2, 1, "", "mint"], [5, 2, 1, "", "quote"], [5, 2, 1, "", "remove_liquidity"], [5, 2, 1, "", "summary"], [5, 2, 1, "", "swap"], [5, 2, 1, "", "swap_exact_tokens_for_tokens"], [5, 2, 1, "", "update_reserves"]], "uniswappy.cpt.exchg.UniswapV3Exchange": [[6, 2, 1, "", "burn"], [6, 2, 1, "", "checkTicks"], [6, 2, 1, "", "collect"], [6, 2, 1, "", "get_liquidity"], [6, 2, 1, "", "get_reserve"], [6, 2, 1, "", "get_virtual_reserve"], [6, 2, 1, "", "initialize"], [6, 2, 1, "", "mint"], [6, 2, 1, "", "nextTick"], [6, 2, 1, "", "setFeeProtocol"], [6, 2, 1, "", "summary"], [6, 2, 1, "", "swap"], [6, 2, 1, "", "swap0ForExact1"], [6, 2, 1, "", "swap1ForExact0"], [6, 2, 1, "", "swapExact0For1"], [6, 2, 1, "", "swapExact1For0"]], "uniswappy.cpt.factory": [[6, 1, 1, "", "UniswapFactory"]], "uniswappy.cpt.factory.UniswapFactory": [[6, 2, 1, "", "deploy"], [6, 2, 1, "", "get_exchange"], [6, 2, 1, "", "get_token"]], "uniswappy.cpt.index": [[5, 1, 1, "", "RebaseIndexToken"], [5, 1, 1, "", "SettlementLPToken"]], "uniswappy.cpt.index.RebaseIndexToken": [[5, 2, 1, "", "apply"]], "uniswappy.cpt.index.SettlementLPToken": [[5, 2, 1, "", "apply"]], "uniswappy.cpt.quote": [[5, 1, 1, "", "IndexTokenQuote"], [5, 1, 1, "", "LPQuote"]], "uniswappy.cpt.quote.IndexTokenQuote": [[5, 2, 1, "", "base_x_asset"], [5, 2, 1, "", "base_y_asset"], [5, 2, 1, "", "get_base_lp"], [5, 2, 1, "", "get_native_x"], [5, 2, 1, "", "get_native_y"], [5, 2, 1, "", "get_x"], [5, 2, 1, "", "get_y"]], "uniswappy.cpt.quote.LPQuote": [[5, 2, 1, "", "get_amount"], [5, 2, 1, "", "get_amount_from_lp"], [5, 2, 1, "", "get_liquidity"], [5, 2, 1, "", "get_lp_from_amount"], [5, 2, 1, "", "get_opposing_token"], [5, 2, 1, "", "get_price"], [5, 2, 1, "", "get_reserve"]], "uniswappy": [[6, 0, 0, "-", "erc"]], "uniswappy.erc": [[6, 1, 1, "", "ERC20"], [6, 1, 1, "", "LPERC20"]], "uniswappy.erc.ERC20": [[6, 2, 1, "", "deposit"], [6, 2, 1, "", "transfer"]], "uniswappy.erc.LPERC20": [[6, 2, 1, "", "add_token_lp"], [6, 2, 1, "", "remove_token_lp"], [6, 2, 1, "", "set_token_lp"]], "uniswappy.process": [[0, 0, 0, "-", "deposit"], [0, 0, 0, "-", "join"], [0, 0, 0, "-", "liquidity"], [0, 0, 0, "module-0", "swap"]], "uniswappy.process.deposit": [[0, 1, 1, "", "SwapDeposit"]], "uniswappy.process.deposit.SwapDeposit": [[0, 2, 1, "", "apply"], [0, 2, 1, "", "get_trading_token"]], "uniswappy.process.join": [[0, 1, 1, "", "Join"]], "uniswappy.process.join.Join": [[0, 2, 1, "", "apply"]], "uniswappy.process.liquidity": [[0, 1, 1, "", "AddLiquidity"], [0, 1, 1, "", "RemoveLiquidity"]], "uniswappy.process.liquidity.AddLiquidity": [[0, 2, 1, "", "apply"]], "uniswappy.process.liquidity.RemoveLiquidity": [[0, 2, 1, "", "apply"]], "uniswappy.process.swap": [[0, 1, 1, "", "Swap"], [0, 1, 1, "", "WithdrawSwap"]], "uniswappy.process.swap.Swap": [[0, 2, 1, "", "apply"]], "uniswappy.process.swap.WithdrawSwap": [[0, 2, 1, "", "apply"], [0, 2, 1, "", "get_trading_token"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"]}, "titleterms": {"uniswap": [0, 1, 5, 6, 9, 10, 12, 15], "join": [0, 7, 8, 13, 16], "swap": [0, 7, 8, 11, 13, 14, 16], "withdraw": [0, 14], "deposit": [0, 11], "liquid": [0, 7, 8], "defipi": 1, "defi": 1, "analyt": 1, "python": 1, "v2": [1, 5, 9, 13], "exampl": 1, "v3": [1, 6, 15, 16], "balanc": [1, 3, 7, 8], "stableswap": [1, 4, 8], "welcom": 1, "s": 1, "document": 1, "content": 1, "high": 2, "level": 2, "overview": 2, "primit": 2, "interfac": [2, 13, 16], "abstract": [2, 13, 16], "object": 2, "constant": [3, 5, 6], "weight": 3, "product": [3, 5, 6], "trade": [3, 4, 5, 6], "vault": [3, 4], "quot": [3, 4, 5], "token": [3, 4, 5, 6, 7, 8, 14], "compos": 4, "stabl": 4, "index": [5, 10], "benchmark": 7, "paramet": [7, 8], "pool": [7, 8], "price": [7, 8], "out": 7, "given": 7, "add": [7, 8], "amount": 7, "lp": 7, "share": 7, "remov": [7, 8], "all": 8, "asset": 8, "usdc": 8, "dai": 8, "usdt": 8, "check": [8, 10, 11], "exchang": 8, "math": 8, "problem": [10, 11, 14], "defin": [10, 11, 14], "settlement": 10, "us": 10, "uniswappi": 10, "naiv": 10, "approach": 10, "final": [10, 11, 14], "solv": [11, 14], "step": [11, 14], "basic": 12, "simul": 12, "addliquid": [13, 16], "removeliquid": [13, 16], "swapdeposit": [13, 16], "withdrawswap": [13, 14, 16], "distribut": 14, "solut": 14, "instal": 17}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "nbsphinx": 4, "sphinx": 56}})